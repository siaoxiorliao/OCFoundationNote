# copy机制与initWithString原理

我的理解应该是对的

#### Copy
* 用常量创建方式,存储指针存储在常量区,不需要内存管理.
* init或类工厂方法创建对象时存储在堆区,需要内存管理,该方式会生成新对象或只是对原有对象进行引用,具体是由xcode版本或是平台(iOS,Mac OS)即编译器决定的,可以自己测试编译器机制.</br>
(1)在initWithString方法中内部机制实际上进行了copy,而copy分为深拷贝和浅拷贝</br>
(2)copy方法又分为copy和mutableCopy,copy默认告诉编译器我要你生成不可变对象,mutable生成可变对象</br>
(3) 在stringWithFormat中的内部机制实际上是 alloc init了新的对象,所以这个方法不管怎么样,都会返回一个新的对象给你接收
#### initWithString:
* 若你传入的是可变对象,接收的是不可变对象或是可变对象,考虑到拷贝的意义(拷贝不会影响源文件,对源文件编辑不会影响拷贝出的文件,对拷贝出的文件编辑不会影响源文件),会是深拷贝,所以编译器肯定会为你创建一个新的对象并返回给你.
* 若你传入的是不可变对象,接受的是不可变对象,考虑到拷贝的意义(不管你需求怎么样,传入和接收的都是不可变的,这个拷贝没有意义,实际上这是编译器的优化),所以这是浅拷贝,不会返回新的对象,但是会让你的指针和传入对象的指针指向同一个对象.
同理,若接收的是可变对象,两个对象性质不一样,就会创建新的对象返回给你,是深拷贝.

